# Guide to Malware Analysis

## Components of malware analysis

1. Basic static analysis
2. Basic dynamic analysis
3. Reverse engineering
4. Debugging

## Basic static analysis

- VirusTotal scan
- Hashing
- Strings
- PEiD - detect packer
- UPX - UPX unpacker
- Dependency walker - list dynamically linked functions
- PEView - view PE files
- Resource Hacker - view `.rsrc` section

## Evading antivirus signatures

from the "Antivirus Hacker's Handbook"

### Some basic methods

- Binary padding
- Dividing malware into smaller pieces, then making sure each piece isn't detected

### A systematic method

1. Where are the malware definition files?
2. What is their file format?
3. How is the signature encoded in malware definition files?
4. What are some edge cases the signature doesn't consider?

### Tips

- Check your work using VirusTotal
- Remove/add unneeded information from PEs and PDFs, obfuscate Javascript

## Types of malware

- Worms
- Viruses
- Trojans
- Bots
- Ransomware
- Cryptominer
- Adware
- Spyware
- Backdoor
- Downloader
- Wiper
- Bootkit

### Worms vs viruses

- Worms can spread on their own
- For example, a worm may port scan other machines on a subnet and exploit an SSH vulnerability
- Viruses require user action
- For example, an "ILUVYOU" email (with an attached infected Office file) that implores you to forward it to your contacts
